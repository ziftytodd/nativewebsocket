{"version":3,"file":"plugin.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst NativeWebsocket = registerPlugin('NativeWebsocket', {\n    web: () => import('./web').then(m => new m.NativeWebsocketWeb()),\n});\nexport * from './definitions';\nexport { NativeWebsocket };\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\nexport class NativeWebsocketWeb extends WebPlugin {\n    constructor() {\n        super(...arguments);\n        this.webSocket = null;\n    }\n    async connect(options) {\n        this.webSocket = new WebSocket(options.url);\n        this.webSocket.binaryType = 'arraybuffer';\n        this.webSocket.onopen = () => {\n            // Connected!\n            console.log('[WS] Connected');\n            this.notifyListeners('connected', { connected: true });\n        };\n        this.webSocket.onmessage = async (msg) => {\n            // Got message\n            console.log('[WS] Message received', msg);\n            if (msg.data instanceof ArrayBuffer) {\n                this.notifyListeners('message', { data: msg.data, binary: true });\n            }\n            else {\n                this.notifyListeners('message', { data: msg.data, binary: false });\n            }\n        };\n        this.webSocket.onerror = (err) => {\n            // Got error\n            console.log('[WS] ERROR', err);\n            this.webSocket = null;\n            this.notifyListeners('disconnected', { reason: 'unknown', error: 'unknown' });\n        };\n        this.webSocket.onclose = (closed) => {\n            console.log('[WS] Closed: ' + (closed ? closed.code : 'NoCode') + ' ' + (closed ? closed.reason : 'NoReason'));\n            this.webSocket = null;\n            this.notifyListeners('disconnected', { reason: 'disconnected', error: 'disconnected' });\n        };\n    }\n    async disconnect() {\n        if (this.webSocket) {\n            this.webSocket.close();\n            this.webSocket = null;\n        }\n        return { disconnected: true };\n    }\n    async send(options) {\n        console.log('[WS] Send', options.message);\n        if (this.webSocket) {\n            this.webSocket.send(options.message);\n            return { sent: true };\n        }\n        return { sent: false };\n    }\n}\n//\n//\n// export interface NativeWebsocketPlugin {\n//     connect(options: { url: string }): Promise<void>;\n//     send(options: { message: string }): Promise<{ sent: boolean }>;\n//     disconnect(): Promise<{ disconnected: boolean }>;\n//\n//     addListener(\n//         eventName: 'connected',\n//         listenerFunc: ConnectedChangeListener,\n//     ): Promise<PluginListenerHandle> & PluginListenerHandle;\n//\n//     addListener(\n//         eventName: 'disconnected',\n//         listenerFunc: DisconnectedChangeListener,\n//     ): Promise<PluginListenerHandle> & PluginListenerHandle;\n//\n//     addListener(\n//         eventName: 'message',\n//         listenerFunc: MessageListener,\n//     ): Promise<PluginListenerHandle> & PluginListenerHandle;\n//\n// }\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin"],"mappings":"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"}